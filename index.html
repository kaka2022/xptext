<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>心动小瓶子</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,sans-serif}
body{background:#fdd1e1;padding:15px}
.main{max-width:400px;margin:0 auto;background:#fff;border-radius:20px;padding:25px}
.title{text-align:center;font-size:24px;color:#ff4a85;margin-bottom:20px}
.bottle-list{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.bottle-item{display:flex;flex-direction:column;align-items:center;gap:6px;padding:6px;cursor:pointer}
.bottle{width:38px;height:56px;border:3px solid #333;border-radius:4px 4px 10px 10px;position:relative;background:#fff;overflow:hidden}
.bottle::before{content:"";position:absolute;top:-8px;left:50%;transform:translateX(-50%);width:16px;height:8px;border:3px solid #333;border-bottom:none;border-radius:4px 4px 0 0;background:#fff}
.water{position:absolute;left:0;right:0;bottom:0;background:#74b1ff;height:0%;transition:height .3s}
.bottle-text{font-size:13px;color:#333}
.share{margin-top:25px;text-align:center}
.share button{background:#ff4a85;color:#fff;border:none;border-radius:50px;padding:12px 28px;font-size:16px;font-weight:700}
</style>

<div class="main">
  <div class="title">心动小瓶子</div>
  <div class="bottle-list" id="list"></div>
  <div class="share"><button onclick="share()">生成并分享到微信</button></div>
</div>

<script>
const words = [
  "眼睛好看","手好看","侧脸杀","声音好听",
  "温柔","耐心","体贴","责任心",
  "衣品好","干净","会做饭","会撒娇",
  "腹肌","高个子","幽默","专一",
  "主动","细节控","安全感","不冷战",
  "宠你","爱笑","阳光","稳重"
];

const list = document.getElementById('list');
const levels = [];

words.forEach((w,i)=>{
  const item = document.createElement('div');
  item.className = 'bottle-item';
  const bottle = document.createElement('div');
  bottle.className = 'bottle';
  const water = document.createElement('div');
  water.className = 'water';
  bottle.appendChild(water);
  const txt = document.createElement('div');
  txt.className = 'bottle-text';
  txt.textContent = w;
  item.appendChild(bottle);
  item.appendChild(txt);
  list.appendChild(item);

  levels[i] = 0;
  item.onclick = ()=>{
    levels[i] = (levels[i]+1) % 6;
    water.style.height = levels[i]*20 + '%';
  }
})

async function share(){
  const data = btoa(JSON.stringify(levels));
  const domain = "https://你的域名.com";
  const url = domain + "/result.html?d=" + data;

  await fetch(domain + "/send.php", {
    method: "POST",
    headers: {"Content-Type":"application/x-www-form-urlencoded"},
    body: "d=" + encodeURIComponent(data)
  });

  location.href = "weixin://dl/business/?appid=wx1&url=" + encodeURIComponent(url);
  setTimeout(()=>alert("已唤起微信！\n结果已发送到管理员邮箱"), 600);
}
</script>
