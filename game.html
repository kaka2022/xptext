<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ­£åœ¨å¡«å†™ - æ¬²æœ›æ¸…å•</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>emailjs.init("k0Jq1yQ1_Y1PQF_lu");</script>
    <style>
        :root { --primary: #ff0055; --bg: #0f0f0f; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: #fff; margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        .header { margin: 20px 0; text-align: center; }
        .header h1 { font-size: 20px; color: var(--primary); }
        
        #bottle-grid { 
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; 
            padding: 20px; width: 85%; max-width: 400px; 
            background: #1a1a1a; border-radius: 25px; 
        }
        
        .bottle-item { display: flex; flex-direction: column; align-items: center; }
        .bottle-svg { width: 60px; height: 85px; }
        .bottle-fill { transition: height 0.3s ease; fill: var(--primary); filter: drop-shadow(0 0 5px var(--primary)); }
        .label { margin-top: 8px; font-size: 13px; font-weight: bold; color: #ccc; text-align: center; }

        .btn-group { margin: 30px 0; display: flex; flex-direction: column; gap: 10px; width: 80%; max-width: 280px; }
        .btn { padding: 15px; border-radius: 30px; border: none; font-size: 16px; font-weight: bold; cursor: pointer; text-align: center; }
        .btn-main { background: var(--primary); color: white; box-shadow: 0 4px 15px rgba(255,0,85,0.4); }
        .btn-back { background: #333; color: #bbb; }
    </style>
</head>
<body>

    <div class="header">
        <h1 id="title">æ¬²æœ›è½½å…¥ä¸­...</h1>
    </div>

    <div id="bottle-grid"></div>

    <div class="btn-group">
        <button class="btn btn-main" onclick="handleShare()">ä¿å­˜æˆ‘çš„XPæ¸…å•</button>
        <button class="btn btn-back" onclick="location.href='index.html'">è¿”å›ä¸»é¡µ</button>
    </div>

    <script>
        const DATA = {
            basic: { title: "å£æ¬²/äº²å»æ¸…å•", items: ["ç§è‰è“", "èˆ”è€³æœµ", "èˆ”ä¹³å¤´", "æŒ‡äº¤/å¸®æ’¸", "è¢«å£", "å¸®å¯¹æ–¹å£", "å£äº¤", "æ·±å–‰", "å£çˆ†", "åç²¾", "é¢œå°„", "èˆ”é˜´", "èˆ”è¶³"] },
            sm: { title: "è½»åº¦è°ƒæ•™æ¸…å•", items: ["æ†ç»‘", "è’™çœ¼", "æ»´èœ¡", "é­æ‰“", "é¡¹åœˆ", "SP/æ‰“å±è‚¡", "ç¾è¾±", "æ”¾ç½®", "å¼ºåˆ¶æ„Ÿ", "è¯ç‰©è¾…åŠ©"] },
            outdoor: { title: "ç¦å¿Œåœ°ç‚¹æ¸…å•", items: ["ç§å®¶è½¦", "å…¬å›­é‡å¤–", "è¯•è¡£é—´", "æ¥¼æ¢¯é—´", "é˜³å°", "åŠå…¬å®¤", "æµ´å®¤", "ç”µå½±é™¢", "é…’åº—è½åœ°çª—"] },
            fetish: { title: "æ‹ç‰©/åˆ¶æœæ¸…å•", items: ["è¿ä½“ä¸è¢œ", "è¿‡è†è¢œ", "å¥³ä»†è£…", "å­¦ç”ŸJK", "æ­»åº“æ°´", "æ——è¢è¯±æƒ‘", "è¥¿è£…é©å±¥", "è•¾ä¸å†…è¡£", "é«˜è·Ÿé‹", "çœ¼é•œå¨˜"] },
            roleplay: { title: "è§’è‰²æ‰®æ¼”æ¸…å•", items: ["åŒ»ç”Ÿ/æŠ¤å£«", "è€å¸ˆ/å­¦ç”Ÿ", "ä¸Šå¸/ä¸‹å±", "ç”µè½¦ç—´æ±‰", "ç»‘åŒª/äººè´¨", "é™Œç”Ÿäººç¤¾äº¤", "ä¸»äºº/å¥´éš¶"] },
            hard: { title: "æ·±åº¦å¼€å‘æ¸…å•", items: ["æ‹³äº¤", "çŒè‚ ", "åœ£æ°´", "ç¾¤P", "æ¢å¦»", "éœ²ä½“", "å¼‚ç‰©æ’å…¥"] }
        };

        const params = new URLSearchParams(window.location.search);
        const catKey = params.get('cat') || 'basic';
        const config = DATA[catKey];
        let state = new Array(config.items.length).fill(0);

        function init() {
            document.getElementById('title').innerText = config.title;
            const res = params.get('res');
            if (res) {
                state = JSON.parse(decodeURIComponent(escape(atob(res))));
                document.querySelectorAll('.btn-main').forEach(b => b.innerText = "æˆ‘ä¹Ÿè¦å¡«");
            }
            render();
        }

        function render() {
            const grid = document.getElementById('bottle-grid');
            grid.innerHTML = config.items.map((item, i) => `
                <div class="bottle-item" onclick="tap(${i})">
                    <svg class="bottle-svg" viewBox="0 0 100 150">
                        <defs><clipPath id="cl${i}"><path d="M30,20 L70,20 L75,40 L85,130 Q85,145 70,145 L30,145 Q15,145 15,130 L25,40 Z" /></clipPath></defs>
                        <path d="M30,20 L70,20 L75,40 L85,130 Q85,145 70,145 L30,145 Q15,145 15,130 L25,40 Z" fill="none" stroke="#444" stroke-width="3"/>
                        <rect class="bottle-fill" x="0" y="${145 - (state[i] * 25)}" width="100" height="${state[i] * 25}" clip-path="url(#cl${i})" />
                    </svg>
                    <div class="label">${item}</div>
                </div>
            `).join('');
        }

        function tap(i) {
            if (params.get('res')) return;
            state[i] = (state[i] + 1) % 6;
            render();
        }

        function handleShare() {
            if (params.get('res')) { location.href = `game.html?cat=${catKey}`; return; }
            const resStr = btoa(unescape(encodeURIComponent(JSON.stringify(state))));
            const url = `${window.location.origin}${window.location.pathname}?cat=${catKey}&res=${resStr}`;
            
            const el = document.createElement('textarea');
            el.value = url;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            alert('ğŸ” æ¬²æœ›æ¸…å•å·²åŠ å¯†ç”Ÿæˆï¼\né“¾æ¥å·²å¤åˆ¶ï¼Œå»å‘é€ç»™ Ta å§ã€‚');
        }

        init();
    </script>
</body>
</html>
